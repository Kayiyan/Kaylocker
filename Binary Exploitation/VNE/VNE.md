# Overview #
- Points : 200
- Tags : `bash` `env` `injection`

# Description #
We've got a binary that can list directories as root, try it out !!

# Hints #
* 1.Have you checked the content of the /root folder
* 2.Find a way to add more instructions to the ls

# Solutions #

Kết nối tới máy chủ của bài :

![image](https://user-images.githubusercontent.com/126185640/230126316-537b117b-7e73-4241-908a-c742a9567d11.png)

Từ `hints` của bài hãy thử `ls` ở đường dẫn hiện tại :

![image](https://user-images.githubusercontent.com/126185640/230126588-0a7b4dca-122a-4e21-ad50-24a3e65ebaf9.png)

Theo bài hãy chạy file `bin` để kiểm tra : 

![image](https://user-images.githubusercontent.com/126185640/230126779-9add1639-9a3f-47bc-ad08-4df80c4d4cb0.png)

Ngắn gọn về lỗi này :  Lỗi: Biến môi trường SECRET_DIR chưa được đặt là thông báo từ chương trình hoặc ứng dụng phần mềm cho biết rằng biến môi trường dự kiến có tên "SECRET_DIR" chưa được đặt.
Trong trường hợp này, chương trình hoặc ứng dụng bạn đang chạy đang cần biến môi trường "SECRET_DIR" được đặt nhưng không tìm thấy. Điều này có nghĩa là chương trình có thể không hoạt động chính xác vì thiếu một phần thông tin quan trọng.

Thông tin thêm về lỗi này : https://stackoverflow.com/questions/39623443/secret-key-errors-with-environment-variables

vì vậy cần đặt giá trị cho biến môi trường và chạy thư mực bin :

![image](https://user-images.githubusercontent.com/126185640/230126996-99b06465-a669-4581-8e3a-a4a6ccf63c1f.png)

Cụ thể : Lệnh `SECRET_DIR=. ./bin` đặt giá trị của biến môi trường `SECRET_DIR` cho thư mục hiện tại (được biểu thị bằng dấu chấm .), sau đó thực thi chương trình hoặc tệp nhị phân bằng cách `./bin`

Thông báo sau khi chạy lệnh trên có thể đề cập đến một số hành động mà chương trình thực hiện sau khi bắt đầu chạy.Có vẻ như chương trình đang liệt kê nội dung của thư mục hiện tại (.) và nó đang làm như vậy với quyền root. Vậy hãy thử liệt kê các thử mục khác với cú pháp lệnh tương tự vậy , cụ thể ở đây mình sẽ liệt kê `/root` :

![image](https://user-images.githubusercontent.com/126185640/230135874-4c47dc56-bfc4-4429-b836-a48452c7e175.png)

Thư mục chứa flie có thể ẩn flag cần tìm , hãy thử đọc nó :

![image](https://user-images.githubusercontent.com/126185640/230136127-78b41dd5-7205-4fbf-97ad-d7a40bda3056.png)

Quyền đọc được từ chối, có thể do chưa `set` biến môi trường vì vậy hãy `set` tương tự như các bước làm trên cho thư mục root đồng thời đọc file đó : 

![image](https://user-images.githubusercontent.com/126185640/230136459-338d59ea-a1df-4367-8006-e257c041604a.png)

flag thu được : `picoCTF{Power_t0_man!pul4t3_3nv_fc3ff2c9}`



