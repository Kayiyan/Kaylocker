# Overview #
- Points : 100
- Tags : `game`

# Description #
Get the flag and reach the exit.
Welcome to BabyGame! Navigate around the map and see what you can find! The game is available to download here. There is no source available, so you'll have to figure your way around the map.

# Hints : #
* Use 'w','a','s','d' to move around.
* There may be secret commands to make your life easy.

# Solutions #

Download file `game` của bài cung cấp hoặc mình đã để nó ở đây : [game](https://github.com/Kayiyan/picoCTF-2023-Writeup/blob/d1f2beaecbd8481ed6eb2e032739a586e54f473c/Binary%20Exploitation/babygame01/game)

file nhị phân nên sẽ cần một số cung cụ để dịch ngược file , ở đây mình sẽ dùng `IDA` và : [Ghidra](https://ghidra-sre.org) hoặc mở `Ghidra` trên máy ảo `Linux` .

Đầu tiên hãy kiểm tra bảo mật của file `game` này bằng [pwntools](https://python3-pwntools.readthedocs.io/en/latest/index.html) với câu lệnh `checksec` :

![image](https://user-images.githubusercontent.com/126185640/230261075-9369b553-29bf-4b9d-9ae9-5975e5e7d332.png)

Mở file `game`với `IDA` :

![image](https://user-images.githubusercontent.com/126185640/230261349-667192d6-020f-4777-b36d-7ff003846ec0.png)

giao diện ban đầu khi mở : 

![image](https://user-images.githubusercontent.com/126185640/230261769-11af4642-6715-4c1c-959e-227ba5c0e8de.png)

Nhấn `F5` sẽ giúp chuyển về pseudocode (C) có thể dễ nhìn nhận hơn : 

![image](https://user-images.githubusercontent.com/126185640/230262273-1c6a57b6-2c81-44a1-8372-a854fb5d8b1d.png)

Tìm kiếm một chút thì hàm `win()` sẽ gọi file `flag.txt` có thể chứa flag thực tế trên server :

![image](https://user-images.githubusercontent.com/126185640/230262426-4e7f7691-8108-4f9c-8b06-8bd48670948c.png)

Đoạn code cần chú ý : 

![image](https://user-images.githubusercontent.com/126185640/230264157-8159413f-067f-4861-b16c-f945fa832efa.png)

Để chiến thắng trò chơi thì biến `v6` cần khác 0 :

cụ thể sẽ nhìn rõ hơn nếu dùng `Ghidra` :

![image](https://user-images.githubusercontent.com/126185640/230265325-d5ae07be-df50-4be5-b7b0-4f8b1ff4b5b2.png)



