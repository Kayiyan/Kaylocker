# Overview #
- Points : 200
- Tags : `linux` `bash` `toctou`

# Description #
Someone created a program to read text files; we think the program reads files with root privileges but apparently it only accepts to read files that are owned by the user running it.
Additional details will be available after launching your challenge instance.

# Solutions #

Từ Tags của bài ta có thể tìm hiểu thêm về `toctou` trên google và từ link sau : https://resources.infosecinstitute.com/topic/race-condition-toctou-vulnerability-lab/
hoặc chi tiết hơn từ link này : https://samsclass.info/127/proj/E10.htm

vận dụng kiến thức từ 2 link trên ta có thể thực hiện trên máy chủ sau khi đã kết nối : 

![image](https://user-images.githubusercontent.com/126185640/230160271-ff408473-fdad-4556-82bf-52d4d5c54977.png)

tạo 1 file tên `attack` hoặc tên gì khác  và thực hiện một số câu lệnh từ đường dẫn mình đề cập ở trên :

![image](https://user-images.githubusercontent.com/126185640/230161278-238236bb-6558-4bb4-a4d5-f035acba6abb.png)


có file flag.txt ở trong đường dẫn này : cần
* Tạo một symbolic link có tên "flip" trỏ đến một tệp có tên "tấn công".
* Tạo symbolic link có tên "flip" trỏ đến tệp có tên "flag.txt".

![image](https://user-images.githubusercontent.com/126185640/230162225-6594b79a-a9cc-464a-a8e2-74e8f8dd7d57.png)


Lệnh ln được sử dụng để tạo các liên kết tượng trưng trong Linux và các hệ điều hành dựa trên Unix khác. Tùy chọn -s được sử dụng để tạo liên kết tượng trưng và tùy chọn -f được sử dụng để buộc liên kết được tạo ngay cả khi tệp có cùng tên đã tồn tại.

Câu lệnh while true tạo ra một vòng lặp vô hạn thực hiện lặp đi lặp lại các lệnh bên trong nó cho đến khi nó bị ngắt.

![image](https://user-images.githubusercontent.com/126185640/230162604-07f40955-6e9c-4ab7-bac8-aab70c48a1bf.png)


Bên trong vòng lặp, lệnh `./txtreader flip` được thực thi. Lệnh này chạy chương trình `txtreader` với  mục đích  của chương trình `txtreader` là nó có thể  tùy chỉnh đọc và xử lý văn bản từ một tệp. Có thể tăng số lần lặp để tìm flag nếu chưa thấy.

flag thu được : `picoCTF{ToctoU_!s_3a5y_5748402c}`
