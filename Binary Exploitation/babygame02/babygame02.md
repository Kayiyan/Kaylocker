# Overview #
- Points : 200
- Tags : `game`

# Description #
Break the game and get the flag.
Welcome to BabyGame 02! Navigate around the map and see what you can find! The game is available to download here. There is no source available, so you'll have to figure your way around the map

# Hints : #
* Use 'w','a','s','d' to move around.
* There may be secret commands to make your life easy.

# Solutions #

Tượng tự như [babygame01](https://github.com/Kayiyan/picoCTF-2023-Writeup/blob/2e7f4ce30ab88890909b97d89fb1b5039a10c627/Binary%20Exploitation/babygame01/babygame01.md) ta tải file [game](https://github.com/Kayiyan/picoCTF-2023-Writeup/blob/060ee37e2b1014825e181ba92629bba8b136bbd7/Binary%20Exploitation/babygame02/game) của bài cung cấp và mở nó với `Ghidra` hoặc `IDA` :

Kiểm tra bảo mật của file :

![image](https://user-images.githubusercontent.com/126185640/230289619-6b9c9fc7-2660-46d5-a612-a4ea756bd89c.png)


Mở file bằng `Ghidra` : 

![image](https://user-images.githubusercontent.com/126185640/230289971-0958230a-1a82-42c3-ab46-0ba191861150.png)

Sẽ cần để ý đến phần này : 

![image](https://user-images.githubusercontent.com/126185640/230290182-17be57d4-47f4-405e-8222-0507951df27b.png)

Khác với `babygame01` ở đây điều kiện chiến thắng ckhác ở chỗ hàm `win` không được gọi rõ ràng , do đó cần phải sửa đổi địa chỉ trả về.

Lệnh `checksec` cho biết `Stack canary` không được bật , vì vậy không cần phải để ý đến .

hàm `move_player` ở bài này sẽ có chút khác với `babygame01` trước khi di chuyển người chơi, nó sẽ ghi vào vị trí của người chơi trước đó (trước khi di chuyển), vì vậy  cần tìm một vị trí chỉ cần một thao tác ghi để chuyển hướng luồng thực thi đến địa chỉ hàm win().

Sử dụng `gdb-gef` và đặt break point tại `move_player` để xem stack của hàm .

Do hàm `move_player()` xóa vị trí người chơi trước đó, việc lặp lại  di chuyển nhân vật của mình từ { 0, 0 } đến vị trí X là -39 sẽ ghi đè các giá trị trong ngăn xếp trên đường di chuyển. ( giá trị -39 có từ việc tính toán underflow ) vì vậy cần viết vị trí hợp lệ .

Điểm bắt đầu của người chơi là {4;4} thông tin lấy từ hàm `int_player` điều này cần chú ý để di chuyển chính xác :

Chạy file `payload` sau khi đã tính toán và kết nối lên server với cổng của bài cung cấp :

![image](https://user-images.githubusercontent.com/126185640/230309784-b0d91828-dead-4f08-8b57-6decf1fb7d0a.png)

![image](https://user-images.githubusercontent.com/126185640/230309813-4606abd6-1764-429a-b2a5-3e093f0104ab.png)

flag thu được : `picoCTF{gamer_jump1ng_4r0unD_498dff8d}`

